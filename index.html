<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì§‘í•© ì¶”ë¦¬ ê²Œì„</title>

<style>
@font-face {
  font-family: 'CookieRun';
  src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.1/CookieRun-Regular.woff') format('woff');
}

* {
  box-sizing: border-box;
}

body {
  font-family: 'CookieRun', sans-serif;
  background:#d0e9f7;
  text-align:center;
  padding:20px;
  font-size:18px;
  margin: 0;
}

h1 { 
  color:#ff7fae; 
  font-size: 2rem;
  margin-bottom: 20px;
}

button {
  font-family:'CookieRun', sans-serif;
  padding:12px 24px;
  border-radius:15px;
  border:none;
  background:#ffccd9;
  color:white;
  font-size:18px;
  cursor:pointer;
  transition: 0.3s;
  margin: 5px;
  touch-action: manipulation;
}

button:hover {
  background:#ff7fae;
}

.content-box {
  background: white;
  border-radius: 15px;
  padding: 15px;
  max-width: 600px;
  margin: 20px auto;
  font-size: 18px;
  line-height: 1.6;
  width: 95%;
}

#gameRules {
  background:white;
  border: 3px dashed #ff7fae;
  text-align:left;
}

#backgroundStory {
  background:#e6f5fc;
}

#suspectList {
  display:flex;
  justify-content:center;
  gap:10px;
  margin-top:15px;
  flex-wrap: wrap;
}

.suspect {
  padding:10px 18px;
  border-radius:15px;
  border:2px solid #ff7fae;
  background:white;
  cursor:pointer;
  font-size:16px;
  margin-bottom: 5px;
}

#speechBubbles {
  display:flex;
  justify-content:center;
  gap:10px;
  margin-top:15px;
  flex-wrap: wrap;
}

.speech {
  background:white;
  border:2px solid #ff7fae;
  border-radius:15px;
  padding:12px;
  width: 260px;
  text-align:left;
  font-size:16px;
  line-height:1.5;
}

@media (max-width: 600px) {
  .speech {
    width: 100%;
    max-width: 100%;
  }
  h1 { font-size: 1.5rem; }
  body { padding: 10px; }
}

#gameArea { display:none; }

#question { font-size:20px; margin-top:20px; word-break: keep-all; }

input {
  padding:10px;
  border-radius:10px;
  border:1px solid #ccc;
  font-size:18px;
  text-align:center;
  width: 80%;
  max-width: 300px;
  margin-bottom: 10px;
}

#message {
  margin-top:10px;
  font-size:20px;
  font-weight:bold;
}

#clues {
  background:#e6f5fc;
  border-radius:15px;
  padding:12px;
  width: 95%;
  max-width: 520px;
  min-height:180px;
  margin:20px auto;
}

#clues p { cursor:pointer; margin:8px 0; padding: 5px; border-bottom: 1px dashed #ccc; }

.notePopup {
  position:absolute;
  background:white;
  border:2px solid #ff7fae;
  border-radius:10px;
  padding:10px;
  font-size:16px;
  display:none;
  max-width:280px;
  white-space:normal;
  z-index: 100;
  box-shadow: 2px 2px 10px rgba(0,0,0,0.2);
  word-break: keep-all;
}

#resultScreen { display:none; }

.feedback-item {
  background: white;
  border: 2px solid #ff7fae;
  border-radius: 12px;
  padding: 10px;
  margin: 10px auto;
  width: 95%;
  max-width: 450px;
  font-size: 16px;
  text-align: left;
  word-wrap: break-word;
}

textarea {
  width: 95%;
  max-width: 420px;
  height: 120px;
  font-family:'CookieRun', sans-serif;
  font-size:18px;
  border-radius:12px;
  border:2px solid #ff7fae;
  padding:10px;
  resize: vertical;
}
</style>
</head>

<body>

<div id="startScreen">
  <h1>ğŸ§© ì§‘í•© ì¶”ë¦¬ ê²Œì„</h1>

  <div id="gameRules" class="content-box">
    <h3>ğŸ“– ê²Œì„ ë°©ë²•</h3>
    1. <b>ì§‘í•© ë¬¸ì œ</b>ë¥¼ í’€ì–´ì£¼ì„¸ìš”.<br>
    2. ì •ë‹µ ì…ë ¥ ì‹œ <b>ìˆ«ìë§Œ ë¶™ì—¬ì„œ(ì˜ˆ: 135)</b> ì ì–´ë„ ë©ë‹ˆë‹¤.<br>
    3. ì •ë‹µì„ ë§íˆë©´ <b>ë‹¨ì„œ</b>ë¥¼ íšë“í•©ë‹ˆë‹¤.<br>
    4. íšë“í•œ <b>ë‹¨ì„œë¥¼ í´ë¦­</b>í•˜ë©´ ìƒì„¸ ë‚´ìš©ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
    5. ëª¨ë“  ë‹¨ì„œë¥¼ ëª¨ì•„ <b>ë²”ì¸ì„ ì§€ëª©</b>í•˜ì„¸ìš”!
  </div>

  <div id="backgroundStory" class="content-box">
    2025ë…„ 8ì›” 22ì¼ ì¼ìš”ì¼, ì™¸ë”´ ì‚°ì¥ ìŠ¤íŠœë””ì˜¤ì—ì„œ ìœ ëª… í™”ê°€ ì•Œë ‰ì‚°ë” ë¸”ë ˆì´í¬(50ì„¸, ë‚¨)ê°€ ì¡°ê°ì¹¼ì— ëª©ì„ ì°”ë¦° ì±„ ì‚¬ë§í–ˆìŠµë‹ˆë‹¤.
    ì‹œì‹ ì€ 8ì‹œ ì •ê°ì— ë°œê²¬ë˜ì—ˆê³ , ì‚¬ë§ ì¶”ì • ì‹œê°„ì€ 7ì‹œ 50ë¶„ì…ë‹ˆë‹¤.
    ìŠ¤íŠœë””ì˜¤ ë¬¸ê³¼ ì°½ë¬¸ì€ ëª¨ë‘ ì ê²¨ìˆëŠ” ì™„ë²½í•œ ë°€ì‹¤ ìƒíƒœì˜€ìŠµë‹ˆë‹¤.
  </div>

  <button onclick="startGame()">ê²Œì„ ì‹œì‘</button>
</div>

<div id="gameArea">

  <div id="suspectList"></div>
  <div id="speechBubbles"></div>

  <p id="question"></p>
  <input id="answer" placeholder="ì˜ˆ: 135 (ìˆ«ìë§Œ ì…ë ¥)" type="tel">
  <br>
  <button onclick="checkAnswer()">ì œì¶œ</button>
  <p id="message"></p>

  <h3>ë‹¨ì„œ ëª©ë¡ (Click!)</h3>
  <div id="clues"></div>
</div>

<div id="resultScreen">
  <h2 id="finalResult"></h2>
  <br>
  <button onclick="goToFeedback()">ğŸ“ ê°ìƒí‰ ë‚¨ê¸°ëŸ¬ ê°€ê¸°</button>
</div>

<div id="feedbackScreen" style="display:none;">
  <h2>ğŸ“ ê°ìƒí‰ ë‚¨ê¸°ê¸°</h2>

  <textarea id="feedbackInput" placeholder="ê²Œì„ì„ í•´ë³¸ ê°ìƒí‰ì„ ì ì–´ì£¼ì„¸ìš”!"></textarea>
  <br><br>

  <button onclick="submitFeedback()">ì œì¶œ</button>

  <h3 style="margin-top:25px;">ğŸ“Œ ë‚¨ê²¨ì§„ ê°ìƒí‰</h3>
  <div id="feedbackList"></div>
</div>

<div id="notePopup" class="notePopup"></div>

<script>
// í˜ì´ì§€ ë¡œë“œ ì‹œ ì €ì¥ëœ ê°ìƒí‰ ë¶ˆëŸ¬ì˜¤ê¸°
window.onload = function() {
  loadFeedback();
};

const suspects = [
  {
    name:"ì—˜ë¦¬ì(ì•Œë ‰ì‚°ë”ì˜ ì¡°ìˆ˜ì´ì ëª¨ë¸)",
    speech:"ì €ëŠ” 7ì‹œ 30ë¶„ë¶€í„° ì£¼ë°©ì—ì„œ ì•„ì¹¨ì„ ì¤€ë¹„í–ˆì–´ìš”. 7ì‹œ 45ë¶„ì¯¤ ì„ ìƒë‹˜ê»˜ì„œ ìŠ¤íŠœë””ì˜¤ë¡œ ë“¤ì–´ê°€ëŠ” ê²ƒì„ ë³´ì•˜ê³ , ê³§ë°”ë¡œ ë¬¸ì´ ì ê¸°ëŠ” ì†Œë¦¬ë¥¼ ë“¤ì—ˆì–´ìš”. ê·¸ë¦¬ê³  ê·¸ í›„ë¡œëŠ” ê³„ì† ì£¼ë°©ì—ë§Œ ìˆì—ˆì–´ìš”."
  },
  {
    name:"ë§ˆì»¤ìŠ¤(ì•Œë ‰ì‚°ë”ì˜ ì¹œêµ¬ì´ì ë¯¸ìˆ í’ˆ ë”œëŸ¬)",
    speech:"ì €ëŠ” 7ì‹œ 40ë¶„ì— ìŠ¤íŠœë””ì˜¤ì— ì ì‹œ ë“¤ëŸ¬ ì˜¤ëŠ˜ ë– ë‚œë‹¤ê³  ì‘ë³„ì¸ì‚¬ë¥¼ í–ˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  7ì‹œ 45ë¶„ì— ë‚˜ì™€ ê³§ë°”ë¡œ ì˜† íœ´ê²Œì‹¤ë¡œ ê°€ì„œ ì§ì„ ì±™ê²¼ìŠµë‹ˆë‹¤. (ëª©ì„ ë§Œì§€ë©°) ì ì‹œë§Œìš”, ë„ˆë¬´ ëª©ì´ ë§ˆë¥´ê³  ë¥ë„¤ìš”. ë¬¼ ì¢€ ë§ˆì‹œëŸ¬ ê°€ë„ ë ê¹Œìš”?"
  },
  {
    name:"ì†Œí”¼ì•„(ì•Œë ‰ì‚°ë”ì˜ ë¶€ì¸ì´ì ì‘ê°€)",
    speech:"7ì‹œ 30ë¶„ë¶€í„° ì •ì›ì—ì„œ ì‚°ì±…í–ˆê³ , 7ì‹œ 50ë¶„ì¯¤ ìŠ¤íŠœë””ì˜¤ ì˜†ì„ ì§€ë‚˜ ë°©ìœ¼ë¡œ ë“¤ì–´ì™”ì–´ìš”. ë…¸ë˜ë¥¼ ë“£ëŠë¼ ì•„ë¬´ëŸ° ì†Œë¦¬ë„ ë“£ì§€ ëª»í–ˆê³ , ê·¸ ë°©ì€ ì•„ë§ˆë„ 7ì‹œ 45ë¶„ë¶€í„° ì ê²¨ìˆì—ˆì„ ê²ë‹ˆë‹¤."
  }
];

const problems = [
  {
    question:"U={1,2,3,4,5,6}, A={1,2,4}, B={2,3,5}, (Aâˆ©B)á¶œ = ?",
    answer:[1,3,4,5,6],
    clue:"ë‹¨ì„œ1: ë°”ë‹¥ì— ì –ì€ ì˜¤ë Œì§€ìƒ‰ ì–¼ë£© ë°œê²¬"
  },
  {
    question:"U={1,2,3,4,5,6}, A={1,3,5}, B={2,3,4}, Aá¶œ âˆª B = ?",
    answer:[2,3,4,6],
    clue:"ë‹¨ì„œ2: ìŠ¤íŠœë””ì˜¤ ë‚´ë¶€ íˆí„° ì˜¨ë„ 28Â°C"
  },
  {
    question:"U={1,2,3,4,5,6}, A={1,2,3}, B={3,4,5}, (AâˆªB)á¶œ = ?",
    answer:[6],
    clue:"ë‹¨ì„œ3: ì°½ë¬¸ ì ê¸ˆì‡  ì£¼ë³€ ë¯¸ì„¸í•œ ìêµ­"
  },
  {
    question:"U={1,2,3,4,5,6}, A={1,2,5}, B={2,3,6}, (AâˆªB)á¶œ = ?",
    answer:[4],
    clue:"ë‹¨ì„œ 4: ëˆ„êµ°ê°€ì˜ ì–¼ìŒ ë°œê²¬"
  },
  {
    question:"U={1,2,3,4,5,6}, A={1,4}, B={2,4,6}, Aá¶œ âˆ© Bá¶œ = ?",
    answer:[3,5],
    clue:"ë‹¨ì„œ5: ìˆ˜ìƒí•œ ë‚¨ì„±ìš© ì½”íŠ¸ì™€ ì…”ì¸  ë°œê²¬"
  }
];

let idx=0;
let clues=[];

function startGame(){
  document.getElementById("startScreen").style.display="none";
  document.getElementById("gameArea").style.display="block";

  suspects.forEach(s=>{
    const b=document.createElement("div");
    b.className="suspect";
    b.innerText=s.name;
    b.onclick=()=>guessSuspect(s.name);
    document.getElementById("suspectList").appendChild(b);

    const sp=document.createElement("div");
    sp.className="speech";
    sp.innerText=`${s.name}\n${s.speech}`;
    document.getElementById("speechBubbles").appendChild(sp);
  });

  showProblem();
}

function showProblem(){
  if(idx>=problems.length){
    document.getElementById("question").innerText="ëª¨ë“  ë¬¸ì œë¥¼ í’€ì—ˆìŠµë‹ˆë‹¤. ë²”ì¸ì„ ì„ íƒí•˜ì„¸ìš”.";
    return;
  }
  document.getElementById("question").innerText=problems[idx].question;
}

// â­ ê°€ì¥ ì¤‘ìš”í•œ ìˆ˜ì • ë¶€ë¶„ â­
function checkAnswer(){
  const rawInput = document.getElementById("answer").value;
  
  // 1. ì…ë ¥ëœ ê°’ì—ì„œ ìˆ«ìë§Œ ì‹¹ ë‹¤ ê¸ì–´ëª¨ìë‹ˆë‹¤. (ì˜ˆ: "1, 3a b 5" -> "135")
  const userDigits = rawInput.replace(/[^0-9]/g, "").split("").sort().join("");
  
  // 2. ì •ë‹µ ë°ì´í„°ë„ ìˆ«ìë§Œ ì‹¹ ê¸ì–´ëª¨ì•„ì„œ ì •ë ¬í•©ë‹ˆë‹¤. (ì˜ˆ: [1,3,5] -> "135")
  const correctDigits = problems[idx].answer.sort().join("");

  // 3. ì•„ë¬´ê²ƒë„ ì…ë ¥ ì•ˆ í–ˆì„ ë•Œ ì²˜ë¦¬
  if (userDigits.length === 0) {
    document.getElementById("message").innerText = "ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!";
    return;
  }

  // 4. ìˆœìˆ˜ ìˆ«ì ë¬¸ìì—´ë¼ë¦¬ ë¹„êµ
  if(userDigits === correctDigits){
    clues.push(problems[idx].clue);
    updateClues();
    idx++;
    showProblem();
    document.getElementById("message").innerText = "ì •ë‹µ!";
    document.getElementById("answer").value = "";
  } else {
    document.getElementById("message").innerText = "í‹€ë ¸ì–´ìš”!";
  }
}

function updateClues(){
  const d=document.getElementById("clues");
  d.innerHTML="";
  clues.forEach(c=>{
    const p=document.createElement("p");
    p.innerText=c;
    p.onclick=e=>showPopup(e,c);
    d.appendChild(p);
  });
}

function showPopup(e,c){
  const p=document.getElementById("notePopup");

  const map={
    "ë‹¨ì„œ1":"í™”í•™ ë¶„ì„ ê²°ê³¼ ì¼ë°˜ ì‚¬ëŒì´ êµ¬í•˜ê¸° ì–´ë ¤ìš´ ê´‘íƒì œì™€ ì ¤ë¼í‹´ ê²€ì¶œ",
    "ë‹¨ì„œ2":"ì‚¬ê±´ ë‹¹ì‹œ ì‹¤ì™¸ ì˜¨ë„ëŠ” 20ë„",
    "ë‹¨ì„œ3":"ì™¸ë¶€ì—ì„œ ì ê¸ˆì‡ ë¥¼ ì¡°ì‘í•œ í”ì  ìˆìŒ",
    "ë‹¨ì„œ4":"ìŠ¤íŠœë””ì˜¤ ë‚´ë¶€ì— ìˆì—ˆì§€ë§Œ ë…¹ì§€ ì•Šì•˜ìŒ",
    "ë‹¨ì„œ5":"ë“± ë¶€ë¶„ì— ì•½ê°„ì˜ ë•€ ì–¼ë£©ì´ ìˆìŒ"
  };

  const key = Object.keys(map).find(k =>
    c.replace(" ", "").includes(k)
  );

  p.innerText = key ? map[key] : "";
  
  if(window.innerWidth < 600) {
    p.style.left = "50%";
    p.style.top = "50%";
    p.style.transform = "translate(-50%, -50%)";
    p.style.position = "fixed";
  } else {
    p.style.left = e.pageX + "px";
    p.style.top = e.pageY + "px";
    p.style.transform = "none";
    p.style.position = "absolute";
  }
  
  p.style.display = "block";

  clearTimeout(p._timer);
  p._timer = setTimeout(()=>p.style.display="none",3000);
}

function guessSuspect(name){
  if(clues.length < problems.length){
    alert("ëª¨ë“  ë‹¨ì„œë¥¼ ëª¨ì•„ì•¼ í•©ë‹ˆë‹¤!");
    return;
  }

  document.getElementById("gameArea").style.display = "none";
  document.getElementById("resultScreen").style.display = "block";

  document.getElementById("finalResult").innerText =
    name.includes("ë§ˆì»¤ìŠ¤")
      ? "ğŸ‰ ì •ë‹µ! ë²”ì¸ì€ ë§ˆì»¤ìŠ¤!"
      : "âŒ ì˜¤ë‹µì…ë‹ˆë‹¤.";
}

function goToFeedback() {
  document.getElementById("resultScreen").style.display = "none";
  document.getElementById("feedbackScreen").style.display = "block";
}

function submitFeedback(){
  const text = document.getElementById("feedbackInput").value;
  if(text.trim()==="") return;

  addFeedbackToDOM(text);
  saveFeedbackToStorage(text);

  document.getElementById("feedbackInput").value = "";
}

function addFeedbackToDOM(text) {
  const box = document.createElement("div");
  box.className = "feedback-item";
  box.innerText = text;
  document.getElementById("feedbackList").appendChild(box);
}

function saveFeedbackToStorage(text) {
  let feedbacks = JSON.parse(localStorage.getItem('gameFeedback')) || [];
  feedbacks.push(text);
  localStorage.setItem('gameFeedback', JSON.stringify(feedbacks));
}

function loadFeedback() {
  let feedbacks = JSON.parse(localStorage.getItem('gameFeedback')) || [];
  feedbacks.forEach(text => {
    addFeedbackToDOM(text);
  });
}
</script>

</body>
</html>